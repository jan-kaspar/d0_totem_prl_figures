import root;
import pad_layout;

include "style.asy";

string f = "/afs/cern.ch/work/j/jkaspar/work/analyses/D0_TOTEM_old/fits/low_t,high_t/e012+e023:f=0.2/st+sy+no/do_fits.root";

xSizeDef = 8cm;

//----------------------------------------------------------------------------------------------------

pen pp;
real sc;
bool point_fill = true;

void DrawPoint(real t, real t_unc, real s, real s_unc, bool d0=false)
{
	transform tr = shift(0, log10(sc));
	draw(tr * (Scale((t-t_unc, s))--Scale((t+t_unc, s))), pp);
	draw(tr * (Scale((t, s-s_unc))--Scale((t, s+s_unc))), pp);

	if (!d0)
		draw(tr * (Scale((t, s))), mCi+1pt+pp + point_fill);
	else
		draw(tr * (Scale((t, s))), mTU+1.5pt+pp + point_fill);
}

//----------------------------------------------------------------------------------------------------

NewPad("$|t|\ung{GeV^2}$", "$\d\si/\d t\ung{mb/GeV^2}$", axesAbove=true);
scale(Linear, Log);

real x_lab = 0.89;

// TOTEM 13 TeV
pp = magenta;
AddToLegend("$\sqrt s = 13\un{TeV}$", mCi+2pt+pp);
draw(RootGetObject(f, "13TeV/g_fit"), "l", pp);
sc = 1;
DrawPoint(0.3409 , 0.0039, 0.4261, 0.0242);
DrawPoint(0.3487 , 0.0039, 0.3495, 0.0199);
DrawPoint(0.3565 , 0.0039, 0.2845, 0.0162);
DrawPoint(0.3643 , 0.0039, 0.2305, 0.0132);
DrawPoint(0.3722 , 0.0039, 0.1858, 0.0106);
DrawPoint(0.3801 , 0.004 , 0.1502, 0.0085);
DrawPoint(0.388  , 0.004 , 0.1211, 0.0068);
DrawPoint(0.396  , 0.004 , 0.0969, 0.0054);
DrawPoint(0.4032 , 0.0032, 0.0793, 0.0044);
DrawPoint(0.4101 , 0.0038, 0.0651, 0.0037);
DrawPoint(0.4168 , 0.003 , 0.0544, 0.0031);
DrawPoint(0.4232 , 0.0034, 0.0466, 0.0026);
DrawPoint(0.4307 , 0.0041, 0.0399, 0.0022);
DrawPoint(0.4372 , 0.0024, 0.0355, 0.0021);
DrawPoint(0.4422 , 0.0026, 0.0328, 0.002 );
DrawPoint(0.4478 , 0.0029, 0.0308, 0.0021);
DrawPoint(0.454  , 0.0033, 0.0291, 0.0018);
DrawPoint(0.4608 , 0.0036, 0.0277, 0.0016);
DrawPoint(0.4682 , 0.0038, 0.0273, 0.0015);
DrawPoint(0.476  , 0.004 , 0.0277, 0.0016);
DrawPoint(0.4842 , 0.0041, 0.0285, 0.0016);
DrawPoint(0.4924 , 0.0041, 0.0295, 0.0017);
DrawPoint(0.5006 , 0.0041, 0.0305, 0.0018);
DrawPoint(0.5088 , 0.004 , 0.0321, 0.0019);
DrawPoint(0.5167 , 0.004 , 0.0337, 0.0019);
DrawPoint(0.5246 , 0.0039, 0.0352, 0.002 );
DrawPoint(0.5323 , 0.0038, 0.0369, 0.0021);
DrawPoint(0.5398 , 0.0037, 0.0383, 0.0022);
DrawPoint(0.5472 , 0.0037, 0.0397, 0.0022);
DrawPoint(0.5546 , 0.0036, 0.0411, 0.0023);
DrawPoint(0.5618 , 0.0036, 0.0427, 0.0024);
DrawPoint(0.5689 , 0.0036, 0.0435, 0.0024);
DrawPoint(0.576  , 0.0035, 0.0444, 0.0025);
DrawPoint(0.5831 , 0.0035, 0.0454, 0.0025);
DrawPoint(0.5901 , 0.0035, 0.0462, 0.0026);
DrawPoint(0.597  , 0.0035, 0.0462, 0.0026);
DrawPoint(0.604  , 0.0035, 0.0469, 0.0026);
DrawPoint(0.611  , 0.0035, 0.0472, 0.0026);
DrawPoint(0.6179 , 0.0035, 0.0479, 0.0027);
DrawPoint(0.6249 , 0.0035, 0.0478, 0.0027);
DrawPoint(0.632  , 0.0035, 0.0483, 0.0027);
DrawPoint(0.6391 , 0.0036, 0.0479, 0.0027);
DrawPoint(0.6462 , 0.0036, 0.0479, 0.0027);
DrawPoint(0.6535 , 0.0036, 0.0479, 0.0027);
DrawPoint(0.6608 , 0.0037, 0.0473, 0.0027);
DrawPoint(0.6682 , 0.0038, 0.0475, 0.0026);
DrawPoint(0.6758 , 0.0038, 0.0466, 0.0026);
DrawPoint(0.6836 , 0.0039, 0.046 , 0.0026);
DrawPoint(0.6915 , 0.004 , 0.0453, 0.0026);
DrawPoint(0.6995 , 0.0041, 0.0446, 0.0025);
DrawPoint(0.7078 , 0.0042, 0.0441, 0.0025);
DrawPoint(0.7163 , 0.0043, 0.043 , 0.0024);
DrawPoint(0.7251 , 0.0044, 0.042 , 0.0024);
DrawPoint(0.7342 , 0.0046, 0.0416, 0.0023);
DrawPoint(0.7435 , 0.0048, 0.0409, 0.0023);
DrawPoint(0.7532 , 0.0049, 0.0394, 0.0022);
DrawPoint(0.7632 , 0.0051, 0.0385, 0.0021);
DrawPoint(0.7737 , 0.0053, 0.0368, 0.0021);
DrawPoint(0.7846 , 0.0056, 0.0357, 0.002 );
DrawPoint(0.7961 , 0.0058, 0.0345, 0.0019);
DrawPoint(0.808  , 0.0061, 0.0331, 0.0018);
DrawPoint(0.8207 , 0.0065, 0.0318, 0.0017);
DrawPoint(0.834  , 0.0069, 0.0302, 0.0017);
DrawPoint(0.8482 , 0.0073, 0.0286, 0.0016);
DrawPoint(0.86279, 0.008 , 0.0269, 0.0016);

// TOTEM 8 TeV
pp = blue;
AddToLegend("$\sqrt s = 8\un{TeV}$", mCi+2pt+pp);
TF1_x_min = 0.38; TF1_x_max = 1.08;
draw(RootGetObject(f, "8TeV/g_fit"), "l", pp);
sc = 1;
DrawPoint(0.3833, 0.0063, 0.2227, 0.0157);
DrawPoint(0.396 , 0.0064, 0.1579, 0.0119);
DrawPoint(0.4088, 0.0064, 0.1199, 0.0091);
DrawPoint(0.4216, 0.0065, 0.0901, 0.0071);
DrawPoint(0.4345, 0.0065, 0.055 , 0.0053);
DrawPoint(0.4475, 0.0065, 0.0416, 0.0042);
DrawPoint(0.4606, 0.0066, 0.0345, 0.0036);
DrawPoint(0.4738, 0.0066, 0.0232, 0.0029);
DrawPoint(0.487 , 0.0066, 0.0226, 0.0027);
DrawPoint(0.5003, 0.0067, 0.0172, 0.0024);
DrawPoint(0.5137, 0.0067, 0.0142, 0.0023);
DrawPoint(0.5272, 0.0068, 0.0151, 0.0023);
DrawPoint(0.5474, 0.0135, 0.0182, 0.002 );
DrawPoint(0.5744, 0.0135, 0.0234, 0.0023);
DrawPoint(0.614 , 0.0261, 0.0287, 0.0023);
DrawPoint(0.6651, 0.025 , 0.0262, 0.0025);
DrawPoint(0.715 , 0.0249, 0.031 , 0.0026);
DrawPoint(0.7671, 0.0272, 0.0286, 0.0024);
DrawPoint(0.8264, 0.0321, 0.0223, 0.0021);
DrawPoint(0.879 , 0.0205, 0.0183, 0.0021);
DrawPoint(1.0337, 0.031 , 0.0086, 0.001 );

// TOTEM 7 TeV
pp = heavygreen;
AddToLegend("$\sqrt s = 7\un{TeV}$", mCi+2pt+pp);
TF1_x_min = 0.37; TF1_x_max = 0.93;
draw(RootGetObject(f, "7TeV/g_fit"), "l", pp);
sc = 1;
DrawPoint(0.3772, 0.0033, 0.2253, 0.0391);
DrawPoint(0.3839, 0.0033, 0.1745, 0.0332);
DrawPoint(0.3907, 0.0035, 0.1573, 0.0281);
DrawPoint(0.3977, 0.0035, 0.1333, 0.0237);
DrawPoint(0.4049, 0.0036, 0.1161, 0.0199);
DrawPoint(0.4122, 0.0038, 0.0926, 0.0168);
DrawPoint(0.4199, 0.0039, 0.0781, 0.0139);
DrawPoint(0.4278, 0.004 , 0.0632, 0.0117);
DrawPoint(0.4361, 0.0042, 0.0537, 0.0097);
DrawPoint(0.4448, 0.0045, 0.0447, 0.0080);
DrawPoint(0.454 , 0.0047, 0.0337, 0.0066);
DrawPoint(0.4637, 0.005 , 0.0302, 0.0054);
DrawPoint(0.474 , 0.0053, 0.0256, 0.0046);
DrawPoint(0.4848, 0.0054, 0.0216, 0.0039);
DrawPoint(0.4959, 0.0057, 0.0195, 0.0034);
DrawPoint(0.5076, 0.006 , 0.0180, 0.0032);
DrawPoint(0.5201, 0.0065, 0.0171, 0.0030);
DrawPoint(0.5332, 0.0066, 0.0161, 0.0020);
DrawPoint(0.5466, 0.0067, 0.0169, 0.0031);
DrawPoint(0.5602, 0.0069, 0.0185, 0.0032);
DrawPoint(0.5739, 0.0068, 0.0183, 0.0034);
DrawPoint(0.5877, 0.007 , 0.0208, 0.0037);
DrawPoint(0.6017, 0.007 , 0.0228, 0.0039);
DrawPoint(0.6155, 0.0069, 0.0222, 0.0041);
DrawPoint(0.6294, 0.007 , 0.0242, 0.0044);
DrawPoint(0.6434, 0.007 , 0.0247, 0.0045);
DrawPoint(0.6572, 0.0069, 0.0274, 0.0047);
DrawPoint(0.6711, 0.007 , 0.0248, 0.0047);
DrawPoint(0.6853, 0.0071, 0.0251, 0.0048);
DrawPoint(0.6995, 0.0072, 0.0273, 0.0048);
DrawPoint(0.7136, 0.0069, 0.0265, 0.0048);
DrawPoint(0.7276, 0.0071, 0.0259, 0.0047);
DrawPoint(0.742 , 0.0073, 0.0250, 0.0046);
DrawPoint(0.7565, 0.0072, 0.0260, 0.0045);
DrawPoint(0.7711, 0.0074, 0.0241, 0.0042);
DrawPoint(0.786 , 0.0074, 0.0232, 0.0041);
DrawPoint(0.8007, 0.0073, 0.0213, 0.0039);
DrawPoint(0.8156, 0.0076, 0.0216, 0.0038);
DrawPoint(0.8309, 0.0078, 0.0189, 0.0035);
DrawPoint(0.8466, 0.0079, 0.0183, 0.0033);
DrawPoint(0.8628, 0.0083, 0.0163, 0.0032);
DrawPoint(0.8796, 0.0085, 0.0164, 0.0030);
DrawPoint(0.897 , 0.0084, 0.0169, 0.0030);
DrawPoint(0.913 , 0.0085, 0.0141, 0.0025);

// TOTEM 2.76 TeV
pp = red;
AddToLegend("$\sqrt s = 2.76\un{TeV}$", mCi+2pt+pp);
TF1_x_min = 0.44; TF1_x_max = 0.85;
draw(RootGetObject(f, "2.76TeV/g_fit"), "l", pp);
sc = 1;
DrawPoint(0.4518, 0.01, 0.127 , 0.0128);
DrawPoint(0.4719, 0.01, 0.0952, 0.0098);
DrawPoint(0.4919, 0.01, 0.0718, 0.0079);
DrawPoint(0.5119, 0.01, 0.0413, 0.0057);
DrawPoint(0.5318, 0.01, 0.0319, 0.0049);
DrawPoint(0.5518, 0.01, 0.0209, 0.0038);
DrawPoint(0.5719, 0.01, 0.0159, 0.0032);
DrawPoint(0.5921, 0.01, 0.0098, 0.0022);
DrawPoint(0.6124, 0.01, 0.0085, 0.002 );
DrawPoint(0.633 , 0.01, 0.0092, 0.0018);
DrawPoint(0.653 , 0.01, 0.0131, 0.0033);
DrawPoint(0.6727, 0.01, 0.0171, 0.0049);
DrawPoint(0.7021, 0.02, 0.0148, 0.003 );
DrawPoint(0.7412, 0.02, 0.0122, 0.0032);
point_fill = false;
DrawPoint(0.8   , 0.04, 0.0171, 0.0049);
point_fill = true;

// extrapolation 1.96 TeV
pp = black;
point_fill = false;
AddToLegend("$\sqrt s = 1.96\un{TeV}$ (extrap.)", mCi+2pt+false+pp);
DrawPoint(0.486140147142593, 0.009103328134492, 0.081432532995515, 0.012374378239514);
DrawPoint(0.517979343255533, 0.009390427618439, 0.047087898870369, 0.006539691761808);
DrawPoint(0.596504072646106, 0.009801516571181, 0.012216117516359, 0.001762948479047);
DrawPoint(0.651560332791308, 0.010339399250097, 0.006242383288143, 0.001752766929662);
DrawPoint(0.718039806233958, 0.016232148258169, 0.009497360274839, 0.002044236130094);
DrawPoint(0.859522341120077, 0.020610904129264, 0.012356545717959, 0.001805343933962);
DrawPoint(0.91503290799268, 0.025366543203122, 0.010803108592891, 0.002636778742504);
DrawPoint(0.97000255036621, 0.030409684526518, 0.006582518818512, 0.001400861254386);

// tab Extrapolation+Fit, cells A48 to I 98
guide g;
g = g--Scale((0.48, 0.091908576093458));
g = g--Scale((0.49, 0.077175382602359));
g = g--Scale((0.5, 0.064643860804149));
g = g--Scale((0.51, 0.054029343546227));
g = g--Scale((0.52, 0.045077885841165));
g = g--Scale((0.53, 0.037564147269794));
g = g--Scale((0.54, 0.031289206642655));
g = g--Scale((0.55, 0.026078357012335));
g = g--Scale((0.56, 0.021778921033965));
g = g--Scale((0.57, 0.018258119056099));
g = g--Scale((0.58, 0.015401015326423));
g = g--Scale((0.59, 0.013108561414771));
g = g--Scale((0.6, 0.011295750453434));
g = g--Scale((0.61, 0.009889891102968));
g = g--Scale((0.62, 0.00882900627393));
g = g--Scale((0.63, 0.008060358548556));
g = g--Scale((0.64, 0.007539101906823));
g = g--Scale((0.65, 0.007227057704021));
g = g--Scale((0.66, 0.007091611790514));
g = g--Scale((0.67, 0.007104729112518));
g = g--Scale((0.68, 0.007242081977298));
g = g--Scale((0.69, 0.007482288289924));
g = g--Scale((0.7, 0.007806256349156));
g = g--Scale((0.71, 0.008196633103303));
g = g--Scale((0.72, 0.008637352994012));
g = g--Scale((0.73, 0.0091132845479));
g = g--Scale((0.74, 0.009609971621575));
g = g--Scale((0.75, 0.010113465598243));
g = g--Scale((0.76, 0.01061024383897));
g = g--Scale((0.77, 0.011087208312083));
g = g--Scale((0.78, 0.011531756605586));
g = g--Scale((0.79, 0.011931915559747));
g = g--Scale((0.8, 0.012276525672223));
g = g--Scale((0.81, 0.012555462394994));
g = g--Scale((0.82, 0.012759878655822));
g = g--Scale((0.83, 0.012882451603719));
g = g--Scale((0.84, 0.012917615898133));
g = g--Scale((0.85, 0.012861766008783));
g = g--Scale((0.86, 0.012713411093119));
g = g--Scale((0.87, 0.012473268130417));
g = g--Scale((0.88, 0.012144282093212));
g = g--Scale((0.89, 0.011731565915809));
g = g--Scale((0.9, 0.01124225767399));
g = g--Scale((0.91, 0.010685297437441));
g = g--Scale((0.92, 0.010071131353574));
g = g--Scale((0.93, 0.009411355291956));
g = g--Scale((0.94, 0.008718314446719));
g = g--Scale((0.95, 0.008004678322226));
g = g--Scale((0.96, 0.007283012250072));
g = g--Scale((0.97, 0.006565366841808));
g = g--Scale((0.98, 0.00586290553381));
draw(g, pp);

// D0 measurement
/*
pp = black;
point_fill = true;
AddToLegend("D0 $\sqrt s = 1.96\un{TeV}$", mTU+1.5pt+true+pp);
DrawPoint(0.26, 0., 47.3e-1, 2.60e-1, true);
DrawPoint(0.30, 0., 21.4e-1, 0.72e-1, true);
DrawPoint(0.34, 0., 10.6e-1, 0.37e-1, true);
DrawPoint(0.38, 0., 5.64e-1, 0.22e-1, true);
DrawPoint(0.42, 0., 2.98e-1, 0.14e-1, true);
DrawPoint(0.46, 0., 14.2e-2, 0.83e-2, true);
DrawPoint(0.50, 0., 7.46e-2, 0.51e-2, true);
DrawPoint(0.54, 0., 3.81e-2, 0.36e-2, true);
DrawPoint(0.58, 0., 2.20e-2, 0.30e-2, true);
DrawPoint(0.64, 0., 1.04e-2, 0.13e-2, true);
DrawPoint(0.72, 0., 1.19e-2, 0.17e-2, true);
DrawPoint(0.80, 0., 9.28e-3, 1.50e-3, true);
DrawPoint(0.88, 0., 11.2e-3, 1.70e-3, true);
DrawPoint(0.96, 0., 8.11e-3, 1.50e-3, true);
DrawPoint(1.04, 0., 5.77e-3, 1.30e-3, true);
DrawPoint(1.12, 0., 5.73e-3, 1.30e-3, true);
DrawPoint(1.20, 0., 2.84e-3, 1.70e-3, true);
*/

label(totemLabel, (0.33, -0.15), E, Fill(white));

limits((0.32, 4e-3), (1.0, 1e0), Crop);

AttachLegend(shift(-5, -5) * BuildLegend(vSkip=-1mm, framePen=nullpen));
